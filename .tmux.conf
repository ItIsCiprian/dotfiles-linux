##### ─────────────────────────────────────────────────────────────
#####  TMUX CONFIG — Linux • Zsh • Truecolor • Catppuccin • TPM
#####  Requires tmux ≥ 3.2 for best results
#####  Prefix: Ctrl-a  |  Reload: Prefix + r
##### ─────────────────────────────────────────────────────────────

##### Shell & Terminal #########################################################

# Use zsh explicitly
set -g default-shell /usr/bin/zsh

# 24-bit color & terminfo
set -g default-terminal "tmux-256color"
set -as terminal-overrides ',*:Tc,xterm-256color:RGB,screen-256color:RGB,tmux-256color:RGB,ghostty:RGB'

# Faster ESC (better for Neovim)
set -sg escape-time 10

# Improve rendering & history
set -g history-limit 100000
set -g aggressive-resize on
set -g focus-events on

##### UX Basics ###############################################################

# Status bar at the top
set -g status-position top
set -g status-interval 5
set -g display-time 2000

# Indexing from 1 (easier on the brain)
set -g base-index 1
setw -g pane-base-index 1
set -g renumber-windows on

# Mouse & vi-mode
set -g mouse on
setw -g mode-keys vi

# Quieter terminal
set -g bell-action none
set -g visual-activity on

# Integrate with terminal clipboard (OSC 52 etc.)
set -g set-clipboard on

##### Prefix & Core Keybinds ###################################################

# Prefix to Ctrl-a (GNU screen muscle memory)
unbind C-b
set -g prefix C-a
bind C-a send-prefix

# Reload config (Prefix + r)
unbind r
bind r source-file ~/.tmux.conf \; display-message "✔ tmux.conf reloaded"

# Pane navigation (vim homerow)
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# Smart splits open in the current pane's path
unbind %
bind | split-window -h -c '#{pane_current_path}'
unbind '"'
bind - split-window -v -c '#{pane_current_path}'

# Resize panes with Shift + H/J/K/L (repeatable)
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

# Maximize/restore pane
bind m resize-pane -Z

# New window in current path
bind c new-window -c '#{pane_current_path}'

# Swap panes easily (Prefix + { / })
bind '{' swap-pane -U
bind '}' swap-pane -D

# Toggle synchronize-panes — Prefix + Ctrl-Y (avoid conflict with copy)
unbind C-y
bind C-y set -w synchronize-panes \; display-message "sync-panes: #{?pane_synchronized,on,off}"

##### Copy Mode (vi) + System Clipboard ########################################

# Vi-like selection
bind -T copy-mode-vi v   send -X begin-selection
bind -T copy-mode-vi V   send -X select-line
bind -T copy-mode-vi C-v send -X rectangle-toggle
bind -T copy-mode-vi y   send -X copy-selection
unbind -T copy-mode-vi MouseDragEnd1Pane

# Pipe yanks to system clipboard (Wayland/X11/macOS)
set -g @copy_to_clipboard 'if command -v wl-copy >/dev/null 2>&1; then wl-copy; elif command -v xclip >/dev/null 2>&1; then xclip -in -selection clipboard; elif command -v pbcopy >/dev/null 2>&1; then pbcopy; else cat >/dev/null; fi'

# In copy-mode-vi: Y = copy selection and exit, pipin

